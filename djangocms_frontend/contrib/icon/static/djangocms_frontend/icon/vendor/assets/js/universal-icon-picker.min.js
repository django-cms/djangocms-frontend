var iconPickerUrl=document.currentScript.src.replace(/js\/([a-z\.-]+)$/gm,""),loadedDependencies=[];!function(i,e){"function"==typeof define&&define.amd?define([],e()):"object"==typeof exports?module.exports=e():i.UniversalIconPicker=e()}(this,(function(){"use strict";var i=function(i,e){var t,s={};for(t in i)Object.prototype.hasOwnProperty.call(i,t)&&(s[t]=i[t]);for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(s[t]=e[t]);return s};function e(e,t){this.selector=e;var s,r;this.options=i({allowEmpty:!0,iconLibraries:null,iconLibrariesCss:null,mode:"autoload",onBeforeOpen:null,onReset:null,onSelect:null,resetSelector:null},t),this.activeLibraryId="",this.filterIcon="",this.iconEventsLoaded=!1,this.iconLibraries={},this.iconLibrariesLoaded=!1,this.iconMarkup="",this.iconWrap="",this.idSuffix="-"+this.selector.replace(/[#\s[\]="]/g,""),this.sideBarBtn="",this.sideBarList=[],this.universalWrap='<div class="uip-modal uip-open" id="uip-modal'+this.idSuffix+'"><div class="uip-modal--content"><div class="uip-modal--header"><div class="uip-modal--header-logo-area"><span class="uip-modal--header-logo-title">Universal Icon Picker</span></div><div class="uip-modal--header-close-btn"><img src="'+iconPickerUrl+'/images/xmark-solid.svg" width="20" height="16" alt="Close" title="Close" /></div></div><div class="uip-modal--body"><div id="uip-modal--sidebar'+this.idSuffix+'" class="uip-modal--sidebar"><div class="uip-modal--sidebar-tabs"></div></div><div id="uip-modal--icon-preview-wrap'+this.idSuffix+'" class="uip-modal--icon-preview-wrap"><div class="uip-modal--icon-search"><input name="" value="" placeholder="Filter by name..."><img src="'+iconPickerUrl+'/images/magnifying-glass-solid.svg" width="20" height="16" alt="Search" title="Search" /></div><div class="uip-modal--icon-preview-inner"><div id="uip-modal--icon-preview'+this.idSuffix+'" class="uip-modal--icon-preview"></div></div></div></div><div class="uip-modal--footer"><button class="uip-insert-icon-button">Insert</button></div></div></div>',this.universalDomEle=(s=this.universalWrap,(r=document.createElement("div")).innerHTML=s,r.firstChild),this.sidebarTabs=this.universalDomEle.querySelector(".uip-modal--sidebar-tabs"),this.previewWrap=this.universalDomEle.querySelector("#uip-modal--icon-preview"+this.idSuffix),this.searchInput=this.universalDomEle.querySelector(".uip-modal--icon-search input"),"autoload"===this.options.mode?this.init():document.querySelector(this.selector).addEventListener("click",this.init.bind(this),{once:!0})}return e.prototype={init:function(){this._loadCssFiles(),"autoload"!==this.options.mode&&this._onBeforeOpen().then((()=>{this.open()})),document.querySelector(this.selector).addEventListener("click",(()=>{this._onBeforeOpen().then((()=>{this.open()}))})),this.options.resetSelector&&document.querySelector(this.options.resetSelector).addEventListener("click",this.options.onReset)},open:function(){this._loadIconLibraries().then((()=>{this.iconLibrariesLoaded=!0,document.getElementById("uip-modal"+this.idSuffix)?(this.universalDomEle.classList.remove("uip-close"),this.universalDomEle.classList.add("uip-open")):(document.body.appendChild(this.universalDomEle),this.universalDomEle.querySelector(".uip-modal--header-close-btn").addEventListener("click",(()=>{this.universalDomEle.classList.add("uip-close"),this.universalDomEle.classList.remove("uip-open")})),this.universalDomEle.querySelector(".uip-insert-icon-button").addEventListener("click",(()=>{let i=this.universalDomEle.querySelector(".universal-selected");if(i){let t=i.querySelector("i").outerHTML,s={libraryId:i.dataset.libraryId,libraryName:i.dataset.libraryName,iconHtml:null,iconMarkup:null,iconClass:null,iconText:null};i.querySelector("i").classList.value.match("uip-icon-none")||(s.iconHtml=t,s.iconMarkup=(e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},t.replace(/[&<>"']/g,(function(i){return e[i]}))),s.iconClass=i.querySelector("i").classList.value,s.iconText=i.querySelector("i").innerText),this.options.onSelect(s)}var e;this.universalDomEle.classList.add("uip-close"),this.universalDomEle.classList.remove("uip-open")}))),this.iconEventsLoaded||(this.universalDomEle.querySelectorAll(".uip-icon-item").forEach((i=>{i.addEventListener("click",(i=>{this.iconWrap.forEach((i=>{i.classList.remove("universal-selected")})),i.currentTarget.classList.toggle("universal-selected")}))})),this.iconEventsLoaded=!0),this.universalDomEle.querySelector(".uip-modal--icon-search input").focus()}))},setOptions:function(e){this.options=i(this.options,e),e.iconLibrariesCss&&this._loadCssFiles(),e.iconLibraries&&(this.iconEventsLoaded=!1,this.iconLibrariesLoaded=!1,this._resetIconAndSidebarList())},_clickHandlerFunc:function(i){i.currentTarget.classList.contains("universal-active")||(this.sideBarBtn.forEach((function(i){i.classList.remove("universal-active")})),i.currentTarget.classList.add("universal-active")),this._sidebarFilterFunc(i.currentTarget.dataset.libraryId)},_iconItemMarkup:function(i,e){var t="",s=e["icon-style"],r=e.prefix;return this.options.allowEmpty&&(t+='<div class="uip-icon-item" data-library-id="'+s+'" data-filter="" data-library-name="'+i+'"><div class="uip-icon-item-inner"><i class="'+r+' uip-icon-none">&nbsp;</i><div class="uip-icon-item-name" title="None">None</div></div></div>'),r.match(/^material-icons/)?e.icons.forEach((function(e){t+='<div class="uip-icon-item" data-library-id="'+s+'" data-filter="'+e+'" data-library-name="'+i+'"><div class="uip-icon-item-inner"><i class="'+r+'">'+e+'</i><div class="uip-icon-item-name" title="'+e+'">'+e.replace("-"," ")+"</div></div></div>"})):e.icons.forEach((function(e){t+='<div class="uip-icon-item" data-library-id="'+s+'" data-filter="'+e+'" data-library-name="'+i+'"><div class="uip-icon-item-inner"><i class="'+[r,e].join("")+'"></i><div class="uip-icon-item-name" title="'+e+'">'+e.replace("-"," ")+"</div></div></div>"})),t},_iconItemPush:function(i){this.previewWrap.innerHTML="",i.forEach((i=>{this.previewWrap.appendChild(i[1])}))},_loadCssFiles:function(){let i=document.createElement("link");loadedDependencies.includes("universal-icon-picker.min.css")||(i.rel="stylesheet",i.type="text/css",i.href=iconPickerUrl+"stylesheets/universal-icon-picker.min.css",i.media="screen",document.head.appendChild(i),loadedDependencies.push("universal-icon-picker.min.css")),this.options.iconLibrariesCss&&this.options.iconLibrariesCss.forEach((e=>{if(!loadedDependencies.includes(e)){let t=iconPickerUrl+"stylesheets/"+e;e.match(/^http|^\/\//)&&(t=e),i=document.createElement("link"),i.rel="stylesheet",i.type="text/css",i.href=t,i.media="screen",document.head.appendChild(i),loadedDependencies.push(e)}}))},_loadIconLibraries:async function(i=0){if(!this.options.iconLibraries)return console.error("Universal icon picker - no icon library loaded"),!1;if(this.iconLibrariesLoaded)return!0;0===i&&this.options.iconLibraries.length>1&&this.sideBarList.push({title:"all icons","list-icon":"","library-id":"all",prefix:""});let e=this.options.iconLibraries[i];await fetch(iconPickerUrl+"icons-libraries/"+e).then((i=>i.json())).then((t=>{let s={};return s[e.replace(/-([a-z])/g,(function(i){return i[1].toUpperCase()})).replace(/\.[a-z.]+$/,"")]=t,Object.assign(this.iconLibraries,s),i+1===this.options.iconLibraries.length?(this._setIconAndSidebarList(),this.activeLibraryId=this.sideBarList[0]["library-id"],this.sidebarTabs.innerHTML=this._sideBarListMarkup(this.sideBarList),this.previewWrap.innerHTML=this.iconMarkup,this.iconWrap=this.previewWrap.querySelectorAll(".uip-icon-item"),this.searchInput.addEventListener("keyup",(r=this._searchFunc,n=100,function(){var i=this,e=arguments,t=function(){o=null,a||r.apply(i,e)},s=a&&!o;clearTimeout(o),o=setTimeout(t,n),s&&r.apply(i,e)}).bind(this),!1),this.sideBarBtn=this.sidebarTabs.querySelectorAll(".uip-modal--sidebar-tab-item"),this.sideBarBtn.forEach((i=>{i.addEventListener("click",this._clickHandlerFunc.bind(this),!1)})),!0):this._loadIconLibraries(i+1);var r,n,a,o})).catch((i=>(console.log(i),i)))},_onBeforeOpen:async function(){if("function"==typeof this.options.onBeforeOpen)return this.options.onBeforeOpen()},_resetIconAndSidebarList:function(){this.sideBarList=[],this.iconMarkup="",this.iconLibraries={},this.iconWrap="",this.filterIcon="",this.sideBarBtn="",this.activeLibraryId=""},_searchFunc:function(i){var e=i.target.value.toLowerCase();this._searchFilterFunc(e,"filter")},_searchFilterFunc:function(i,e){this.filterIcon=Object.entries(this.iconWrap).filter((t=>-1!=t[1].dataset[e].indexOf(i)&&("all"===this.activeLibraryId||t[1].dataset.libraryId===this.activeLibraryId))),this._iconItemPush(this.filterIcon)},_setIconAndSidebarList:function(){for(const[i,e]of Object.entries(this.iconLibraries))this._setSideBarList(i.replace(/([A-Z])/g," $1"),e),this._setIconMarkup(i,e)},_setIconMarkup:function(i,e){void 0!==e.icons?this.iconMarkup+=this._iconItemMarkup(i,e):Object.entries(e).forEach((e=>{this.iconMarkup+=this._iconItemMarkup(i,e[1])}))},_sidebarFilterFunc:function(i){this.activeLibraryId=i,this.filterIcon=Object.entries(this.iconWrap).filter((function(e){return"all"===i||i===e[1].dataset.libraryId})),this._iconItemPush(this.filterIcon)},_setSideBarList:function(i,e){var t;void 0!==e.icons?(t={title:i,prefix:void 0!==e.prefix?e.prefix:"","list-icon":void 0!==e["list-icon"]?e["list-icon"]:"","library-id":void 0!==e["icon-style"]?e["icon-style"]:"all"},this.sideBarList.push(t)):Object.entries(e).forEach((e=>{t={title:i+" - "+e[0],prefix:void 0!==e[1].prefix?e[1].prefix:"","list-icon":void 0!==e[1]["list-icon"]?e[1]["list-icon"]:"","library-id":void 0!==e[1]["icon-style"]?e[1]["icon-style"]:"all"},this.sideBarList.push(t)}))},_sideBarListMarkup:function(i){var e="";return i.forEach((i=>{let t="";if(i["library-id"]===this.activeLibraryId&&(t=" universal-active"),"all"!==i["library-id"]){let s='<i class="'+i["list-icon"]+'"></i>';i.prefix.match(/^material-icons/)&&(s='<i class="'+i.prefix+'">'+i["list-icon"]+"</i>"),e+='<div class="uip-modal--sidebar-tab-item'+t+'" data-library-id="'+i["library-id"]+'">'+s+i.title+"</div>"}else e+='<div class="uip-modal--sidebar-tab-item'+t+'" data-library-id="'+i["library-id"]+'"><img src="'+iconPickerUrl+'/images/star-of-life-solid.svg" width="13.125px" height="auto" alt="All" title="All" />'+i.title+"</div>"})),e}},e}));
//# sourceMappingURL=universal-icon-picker.min.js.map